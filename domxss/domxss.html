<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DOM XSS</title>
    <link rel="stylesheet" href="../style.css">
</head>

<body>
    <h1>Perimeter of DOM XSS</h1>
    <ul>
        <li><a href="#sources">Attacker-controlled sources</a></li>
        <li><a href="#sinks">Injection sinks</a></li>
        <li><a href="#devtools">Chrome DevTools</a></li>
    </ul>
    <hr>
    <h2 id=sources>Attacker-controlled sources</h2>
    By nature you can't build a comprehensive list of DOM XSS sources
    <ol>
        <li>location</li>
        <li>location.href</li>
        <li>location.pathname</li>
        <li>location.search</li>
        <li>location.hash</li>
        <li>document.URL</li>
        <li>document.documentURI</li>
        <li>document.baseURI</li>
    </ol>
    <h2><a href="https://w3c.github.io/webappsec-trusted-types/dist/spec/#injection-sinks" id=sinks>Injection sinks</a></h2>
    <ol>
        <!--HTML Injection Sinks parse input strings into a DOM tree. https://w3c.github.io/webappsec-trusted-types/dist/spec/#html-injection-sinks-->
        <li class="HIS"><a href="https://www.w3.org/TR/DOM-Parsing/#widl-Element-innerHTML">inner.html</a></li>
        <li class="HIS"><a href="https://www.w3.org/TR/DOM-Parsing/#widl-Element-outerHTML">outer.html</a></li>
        <li class="HIS"><a href="https://developer.mozilla.org/en-US/docs/Web/API/DOMParser">DOMParser parseFromString()</a></li>
        <li class="HIS"><a href="https://www.w3schools.com/jsref/met_doc_write.asp">document.write()</a></li>
        <li class="HIS"><a href="https://www.w3schools.com/jsref/met_doc_writeln.asp">document.writeln()</a></li>
        <!-- DOM XSS injection sinks evaluate an input string value in a way that could result in DOM XSS if that value is untrusted -->
        <li class="DXIS"><a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLScriptElement">HTMLScriptElement</a></li>
        <li class="DXIS"><a href="https://w3c.github.io/webappsec-trusted-types/dist/spec/#dom-htmlscriptelement-text">HTMLScriptElement.text</a></li>
        <!-- Sinks that Execute payload As JavaScript https://domgo.at/cxss/sinks -->
        <li class="EAJ"><a href="https://www.w3.org/TR/DOM-Parsing/#widl-Element-innerHTML">eval()</a></li>
        <li class="EAJ"><a href="https://www.w3schools.com/jsref/met_win_settimeout.asp">setTimeout</a></li>
        <li class="EAJ"><a href="https://www.w3schools.com/js/js_timing.asp">setInterval()</a></li>
        <li class="EAJ"><a href="https://www.w3schools.com/js/js_function_definition.asp">function()</a></li>
        <li class="EAJ"><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/script">&lt;script&gt;&lt;/script&gt;</a></li>
        <li class="EAJ"><a href="https://www.w3schools.com/jsref/event_onclick.asp">&lt;div onclick ='payload'&gt;</a></li>
        <!-- Sinks that Evaluate JavaScript URIs https://domgo.at/cxss/sinks -->
        <li class="EJU"><a href="https://www.w3schools.com/js/js_window_location.asp">location</a></li>
        <li class="EJU"><a href="https://www.w3schools.com/jsref/prop_loc_href.asp">location.href</a></li>
        <li class="EJU"><a href="https://developer.mozilla.org/en-US/docs/Web/API/Location/assign">location.assign()</a></li>
        <li class="EJU"><a href="https://developer.mozilla.org/en-US/docs/Web/API/Location/replace">location.replace()</a></li>
        <!-- Sinks that execute payload as HTML https://domgo.at/cxss/sinks -->
        <hr>
        <li class="HIS"><a href="https://www.w3schools.com/jsref/met_doc_writeln.asp">document.writeln()</a></li>
        <li class="DXIS"><a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLScriptElement">HTMLScriptElement</a></li>
        <li class="HIS"><a href="https://www.w3.org/TR/DOM-Parsing/#widl-Element-innerHTML">inner.html</a></li>
        <li class="HIS"><a href="https://www.w3.org/TR/DOM-Parsing/#widl-Element-outerHTML">outer.html</a></li>
        <li class="HIS"><a href="https://developer.mozilla.org/en-US/docs/Web/API/DOMParser">DOMParser parseFromString()</a></li>
        <li class="HIS"><a href="https://www.w3schools.com/jsref/met_doc_write.asp">document.write()</a></li>
        <li class="HIS"><a href="https://www.w3schools.com/jsref/met_doc_writeln.asp">document.writeln()</a></li>
        <li class="DXIS"><a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLScriptElement">HTMLScriptElement</a></li>
        <li class="HIS"><a href="https://www.w3.org/TR/DOM-Parsing/#widl-Element-innerHTML">inner.html</a></li>
        <li class="HIS"><a href="https://www.w3.org/TR/DOM-Parsing/#widl-Element-outerHTML">outer.html</a></li>
        <li class="HIS"><a href="https://developer.mozilla.org/en-US/docs/Web/API/DOMParser">DOMParser parseFromString()</a></li>
        <li class="HIS"><a href="https://www.w3schools.com/jsref/met_doc_write.asp">document.write()</a></li>
        <li class="HIS"><a href="https://www.w3schools.com/jsref/met_doc_writeln.asp">document.writeln()</a></li>
        <li class="DXIS"><a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLScriptElement">HTMLScriptElement</a></li>
        <li class="HIS"><a href="https://www.w3.org/TR/DOM-Parsing/#widl-Element-innerHTML">inner.html</a></li>
        <li class="HIS"><a href="https://www.w3.org/TR/DOM-Parsing/#widl-Element-outerHTML">outer.html</a></li>
        <li class="HIS"><a href="https://developer.mozilla.org/en-US/docs/Web/API/DOMParser">DOMParser parseFromString()</a></li>
        <li class="HIS"><a href="https://www.w3schools.com/jsref/met_doc_write.asp">document.write()</a></li>
        <li class="HIS"><a href="https://www.w3schools.com/jsref/met_doc_writeln.asp">document.writeln()</a></li>
        <li class="DXIS"><a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLScriptElement">HTMLScriptElement</a></li>
        <li class="HIS"><a href="https://www.w3.org/TR/DOM-Parsing/#widl-Element-innerHTML">inner.html</a></li>
        <li class="HIS"><a href="https://www.w3.org/TR/DOM-Parsing/#widl-Element-outerHTML">outer.html</a></li>
        <li class="HIS"><a href="https://developer.mozilla.org/en-US/docs/Web/API/DOMParser">DOMParser parseFromString()</a></li>
        <li class="HIS"><a href="https://www.w3schools.com/jsref/met_doc_write.asp">document.write()</a></li>
        <li class="HIS"><a href="https://www.w3schools.com/jsref/met_doc_writeln.asp">document.writeln()</a></li>
        <li class="DXIS"><a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLScriptElement">HTMLScriptElement</a></li>
        <li class="HIS"><a href="https://www.w3.org/TR/DOM-Parsing/#widl-Element-outerHTML">outer.html</a></li>
        <li class="HIS"><a href="https://developer.mozilla.org/en-US/docs/Web/API/DOMParser">DOMParser parseFromString()</a></li>
        <li class="HIS"><a href="https://www.w3schools.com/jsref/met_doc_write.asp">document.write()</a></li>
        <li class="HIS"><a href="https://www.w3schools.com/jsref/met_doc_writeln.asp">document.writeln()</a></li>
        <li class="DXIS"><a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLScriptElement">HTMLScriptElement</a></li>
        <li class="HIS"><a href="https://www.w3.org/TR/DOM-Parsing/#widl-Element-innerHTML">inner.html</a></li>
        <li class="HIS"><a href="https://www.w3.org/TR/DOM-Parsing/#widl-Element-outerHTML">outer.html</a></li>
        <li class="HIS"><a href="https://developer.mozilla.org/en-US/docs/Web/API/DOMParser">DOMParser parseFromString()</a></li>
        <li class="HIS"><a href="https://www.w3schools.com/jsref/met_doc_write.asp">document.write()</a></li>
        <li class="HIS"><a href="https://www.w3schools.com/jsref/met_doc_writeln.asp">document.writeln()</a></li>
        <li class="DXIS"><a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLScriptElement">HTMLScriptElement</a></li>
    </ol>
    <hr>
    <h2 id=devtools>Chrome DevTools</h2>
    <ol>
        <li><a href="scanners.html">Scanners</a></li>
        <li><a href="https://developer.mozilla.org/en-US/docs/Web/API/console#Stack_traces">console.stack()</a></li>
    </ol>
</body>

</html>